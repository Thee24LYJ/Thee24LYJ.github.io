<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>C/C++ä¹‹socketç¼–ç¨‹ | theeã®åšå®¢ ğŸ‰</title><meta name="author" content="thee"><meta name="copyright" content="thee"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="å‚è€ƒæ–‡ç« ï¼š 1.socketç¼–ç¨‹åŸºç¡€çŸ¥è¯† 2.socketç¼–ç¨‹UDPç¨‹åº 3.socketç¼–ç¨‹TCPç¨‹åº 4.unix domain socket ç¼–ç¨‹ 5.Unix Domain Socket å®ç°åŸç† 6.Linux C Socket UDPç¼–ç¨‹è¯¦è§£åŠå®ä¾‹åˆ†äº« 7.Linuxç¼–ç¨‹ä¹‹UDP SOCKETå…¨æ”»ç•¥ 8.udp è¶…æ—¶è®¾ç½®ï¼ˆselectå‡½æ•°çš„ä¸€ç§ç”¨æ³•ï¼‰  å‰è¨€ socketé€šä¿¡æœ¬è´¨ä¸Šå°±">
<meta property="og:type" content="article">
<meta property="og:title" content="C&#x2F;C++ä¹‹socketç¼–ç¨‹">
<meta property="og:url" content="http://example.com/2023/07/10/C-C-%E4%B9%8Bsocket%E7%BC%96%E7%A8%8B/index.html">
<meta property="og:site_name" content="theeã®åšå®¢ ğŸ‰">
<meta property="og:description" content="å‚è€ƒæ–‡ç« ï¼š 1.socketç¼–ç¨‹åŸºç¡€çŸ¥è¯† 2.socketç¼–ç¨‹UDPç¨‹åº 3.socketç¼–ç¨‹TCPç¨‹åº 4.unix domain socket ç¼–ç¨‹ 5.Unix Domain Socket å®ç°åŸç† 6.Linux C Socket UDPç¼–ç¨‹è¯¦è§£åŠå®ä¾‹åˆ†äº« 7.Linuxç¼–ç¨‹ä¹‹UDP SOCKETå…¨æ”»ç•¥ 8.udp è¶…æ—¶è®¾ç½®ï¼ˆselectå‡½æ•°çš„ä¸€ç§ç”¨æ³•ï¼‰  å‰è¨€ socketé€šä¿¡æœ¬è´¨ä¸Šå°±">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Thee24LYJ/Pic_Image/images/022c23204ba7816e279cc352e332b74b6f656da2.png">
<meta property="article:published_time" content="2023-07-10T12:02:37.000Z">
<meta property="article:modified_time" content="2023-07-11T12:02:23.722Z">
<meta property="article:author" content="thee">
<meta property="article:tag" content="socketç¼–ç¨‹">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Thee24LYJ/Pic_Image/images/022c23204ba7816e279cc352e332b74b6f656da2.png"><link rel="shortcut icon" href="/assets/img/plane.png"><link rel="canonical" href="http://example.com/2023/07/10/C-C-%E4%B9%8Bsocket%E7%BC%96%E7%A8%8B/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":50,"languages":{"author":"ä½œè€…: thee","link":"é“¾æ¥: ","source":"æ¥æº: theeã®åšå®¢ ğŸ‰","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'C/C++ä¹‹socketç¼–ç¨‹',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-07-11 20:02:23'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/cat.css"><link rel="stylesheet" href="/assets/css/custom.css"><link rel="stylesheet" href="/assets/css/progress_bar.css" media="defer" onload="this.media='all'"><div id="myscoll"></div><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/assets/img/test.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> æ¸…å•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/changes/"><i class="fa-fw fas fa-calendar-alt"></i><span> æ›´æ–°è®°å½•</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/Thee24LYJ/Pic_Image/images/022c23204ba7816e279cc352e332b74b6f656da2.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">theeã®åšå®¢ ğŸ‰</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> æ¸…å•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/changes/"><i class="fa-fw fas fa-calendar-alt"></i><span> æ›´æ–°è®°å½•</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">C/C++ä¹‹socketç¼–ç¨‹</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-07-10T12:02:37.000Z" title="å‘è¡¨äº 2023-07-10 20:02:37">2023-07-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-07-11T12:02:23.722Z" title="æ›´æ–°äº 2023-07-11 20:02:23">2023-07-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C-C/">C/C++</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">4.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>14åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="C/C++ä¹‹socketç¼–ç¨‹"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>å‚è€ƒæ–‡ç« ï¼š</p>
<p>1.<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_52169086/article/details/125687577?spm=1001.2014.3001.5506">socketç¼–ç¨‹åŸºç¡€çŸ¥è¯†</a></p>
<p>2.<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_52169086/article/details/125691474?spm=1001.2014.3001.5506">socketç¼–ç¨‹UDPç¨‹åº</a></p>
<p>3.<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_52169086/article/details/125698902?spm=1001.2014.3001.5506">socketç¼–ç¨‹TCPç¨‹åº</a></p>
<p>4.<a target="_blank" rel="noopener" href="https://juejin.cn/s/unix%20domain%20socket%20%E7%BC%96%E7%A8%8B">unix domain socket ç¼–ç¨‹</a></p>
<p>5.<a target="_blank" rel="noopener" href="https://github.com/linalalala/linux/blob/master/socket_unix.md">Unix Domain Socket å®ç°åŸç†</a></p>
<p>6.<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/131402832">Linux C Socket UDPç¼–ç¨‹è¯¦è§£åŠå®ä¾‹åˆ†äº«</a></p>
<p>7.<a target="_blank" rel="noopener" href="https://www.cnblogs.com/skyfsm/p/6287787.html">Linuxç¼–ç¨‹ä¹‹UDP SOCKETå…¨æ”»ç•¥</a></p>
<p>8.<a target="_blank" rel="noopener" href="https://www.cnblogs.com/liang-hk/archive/2012/04/28/2475199.html">udp è¶…æ—¶è®¾ç½®ï¼ˆselectå‡½æ•°çš„ä¸€ç§ç”¨æ³•ï¼‰</a></p>
</blockquote>
<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><ul>
<li><p><code>socket</code>é€šä¿¡æœ¬è´¨ä¸Šå°±æ˜¯ä¸¤ä¸ªè¿›ç¨‹é—´çš„é€šä¿¡(<strong>è·¨ç½‘ç»œçš„è¿›ç¨‹é—´é€šä¿¡</strong>)</p>
</li>
<li><p><code>IP</code>åœ°å€èƒ½å¤Ÿå”¯ä¸€æ ‡è¯†å…¬ç½‘å†…çš„ä¸€å°ä¸»æœºï¼Œè€Œç«¯å£å·èƒ½å¤Ÿå”¯ä¸€æ ‡è¯†ä¸€å°ä¸»æœºä¸Šçš„ä¸€ä¸ªè¿›ç¨‹ï¼Œå› æ­¤<code>IP</code>åœ°å€+ç«¯å£å·å°±èƒ½å¤Ÿå”¯ä¸€æ ‡è¯†ç½‘ç»œä¸Šçš„æŸä¸€å°ä¸»æœºçš„æŸä¸€ä¸ªè¿›ç¨‹</p>
</li>
<li><p>æˆ–è€…è¿™æ ·è¯´ï¼š<code>IP</code>åœ°å€å°±åƒæ˜¯æŸä¸ªå¿«é€’ç‚¹çš„ä½ç½®ï¼Œç«¯å£å·å°±æ˜¯å…¶ä¸­å¿«é€’åŒ…è£¹çš„ç¼–å·ï¼Œè€Œè¿›ç¨‹æ˜¯æ”¶æˆ–å¯„å¿«é€’çš„äºº</p>
</li>
<li><p><code>TCP</code>åè®®ï¼šé¢å‘è¿æ¥ã€å¯é ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®</p>
</li>
<li><code>UDP</code>åè®®ï¼šæ— éœ€å»ºç«‹è¿æ¥çš„ã€ä¸å¯é çš„ã€é¢å‘æ•°æ®æŠ¥çš„ä¼ è¾“å±‚é€šä¿¡åè®®</li>
<li>è®¡ç®—æœºå­˜å‚¨ç­–ç•¥ï¼š<ul>
<li>å¤§ç«¯æ¨¡å¼ï¼šæ•°æ®é«˜å­—èŠ‚ä¿å­˜åˆ°å†…å­˜ä½å­—èŠ‚ï¼Œæ•°æ®ä½å­—èŠ‚ä¿å­˜åˆ°å†…å­˜é«˜å­—èŠ‚(å¤§å¯¹å°ï¼Œå°å¯¹å¤§/==ä½åœ°å€é«˜å­—èŠ‚==) -&gt; ç½‘ç»œæ•°æ®æµé‡‡ç”¨<strong>å¤§ç«¯æ¨¡å¼</strong></li>
<li>å°ç«¯æ¨¡å¼ï¼šæ•°æ®é«˜å­—èŠ‚ä¿å­˜åˆ°å†…å­˜é«˜å­—èŠ‚ï¼Œæ•°æ®ä½å­—èŠ‚ä¿å­˜åˆ°å†…å­˜ä½å­—èŠ‚(å¤§å¯¹å¤§ï¼Œå°å¯¹å°/==ä½åœ°å€ä½å­—èŠ‚==)</li>
</ul>
</li>
<li>ç½‘ç»œå­—èŠ‚åºå’Œä¸»æœºå­—èŠ‚åºä¹‹é—´çš„è½¬æ¢å‡½æ•°ï¼š</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">htonl</span><span class="params">(<span class="type">uint32_t</span> hostlong)</span>;	<span class="comment">//ä¸»æœºå­—èŠ‚åºè½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åº 32ä½</span></span><br><span class="line"><span class="type">uint16_t</span> <span class="title function_">htons</span><span class="params">(<span class="type">uint16_t</span> hostshort)</span>;	<span class="comment">//ä¸»æœºå­—èŠ‚åºè½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åº 16ä½</span></span><br><span class="line"><span class="type">uint32_t</span> <span class="title function_">ntohl</span><span class="params">(<span class="type">uint32_t</span> netlong)</span>;	<span class="comment">//ç½‘ç»œå­—èŠ‚åºè½¬æ¢ä¸ºä¸»æœºå­—èŠ‚åº 32ä½</span></span><br><span class="line"><span class="type">uint16_t</span> <span class="title function_">ntohs</span><span class="params">(<span class="type">uint16_t</span> netshort)</span>;	<span class="comment">//ç½‘ç»œå­—èŠ‚åºè½¬æ¢ä¸ºä¸»æœºå­—èŠ‚åº 16ä½</span></span><br><span class="line"><span class="comment">// h: host	n: network</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>sockaddr</code>ç»“æ„(è·¨ç½‘ç»œé€šä¿¡ï¼š<code>sockaddr_in</code>å’Œæœ¬åœ°é€šä¿¡ï¼š<code>sockaddr_un</code>)ï¼šç»Ÿä¸€å¥—æ¥å­—çš„ç½‘ç»œé€šä¿¡å’Œæœ¬åœ°é€šä¿¡ï¼Œä½¿ä¹‹èƒ½ä½¿ç”¨åŒä¸€å¥—å‡½æ•°ï¼›è®¾ç½®å‚æ•°æ—¶é€šè¿‡è®¾ç½®åè®®å®¶æ—(<code>16</code>ä½åœ°å€ç±»å‹)è¿™ä¸ªå­—æ®µï¼Œæ¥è¡¨æ˜æˆ‘ä»¬æ˜¯è¦è¿›è¡Œç½‘ç»œé€šä¿¡è¿˜æ˜¯æœ¬åœ°é€šä¿¡ï¼›å®é™…è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œå®šä¹‰çš„è¿˜æ˜¯<code>sockaddr_in</code>ç»“æ„ä½“ï¼Œåœ¨ä¼ å‚æ—¶å°†è¯¥ç»“æ„ä½“çš„åœ°å€ç±»å‹å¼ºåˆ¶è½¬æ¢ä¸º<code>sockaddr*</code> </li>
<li><code>UDP</code>é€šä¿¡æµç¨‹æ¡†æ¶å›¾<ul>
<li><code>server</code>(æœåŠ¡å™¨)æ¥æ”¶è¯·æ±‚æ­¥éª¤ï¼š<code>socket()-&gt;bind()-&gt;recvfrom()</code></li>
<li><code>client</code>(å®¢æˆ·ç«¯)å‘é€è¯·æ±‚æ­¥éª¤ï¼š<code>socket()-&gt;sendto()</code></li>
<li>å®é™…ä¸Š<code>UDP</code>æ²¡æœ‰ä¸¥æ ¼åŒºåˆ†<code>server</code>ç«¯å’Œ<code>client</code>ç«¯ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ç»‘ä¸ç»‘å®šï¼ˆ<code>bind</code>ï¼‰ç«¯å£</li>
</ul>
</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Thee24LYJ/Pic_Image/images/1093303-20170115195937619-2089905370.jpg" alt="1093303-20170115195937619-2089905370"></p>
<h1 id="å¥—æ¥å­—ç›¸å…³å‡½æ•°"><a href="#å¥—æ¥å­—ç›¸å…³å‡½æ•°" class="headerlink" title="å¥—æ¥å­—ç›¸å…³å‡½æ•°"></a>å¥—æ¥å­—ç›¸å…³å‡½æ•°</h1><h3 id="1-socket"><a href="#1-socket" class="headerlink" title="1.socket()"></a>1.socket()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;sys/types.h&gt;</span><br><span class="line">#include&lt;sys/socket.h&gt;</span><br><span class="line"></span><br><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">int socket(int domain, int type, int protocol);</span><br><span class="line">ä½œç”¨: å»ºç«‹å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">å‚æ•°:</span><br><span class="line">(1) domain(ä»¥ä¸‹åˆ—å‡ºå¸¸ç”¨ç½‘ç»œé€šä¿¡åŸŸ)</span><br><span class="line">	AF_INET: å¸¸ç”¨åè®®ï¼Œä½¿ç”¨TCPæˆ–UDPä¼ è¾“(ç”¨äºIPV4)</span><br><span class="line">	AF_INET6: åŒä¸Šï¼ŒåŒºåˆ«åœ¨äºæ˜¯ç”¨äºIPV6</span><br><span class="line">	AF_UNIX: æœ¬åœ°åè®®ï¼Œç”¨äºUnixå’ŒLInuxç³»ç»Ÿ(æ˜¯åŒä¸€å°ä¸»æœºå†…è¿›ç¨‹é—´é€šä¿¡çš„æœºåˆ¶ï¼Œä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿè·¯å¾„åä½œä¸ºåœ°å€æ¥å»ºç«‹è¿æ¥ï¼Œæ¯”ä¼ ç»Ÿçš„ç½‘ç»œSocketæ›´åŠ é«˜æ•ˆ)</span><br><span class="line">(2) type</span><br><span class="line">	SOCK_STREAM: TCPä¼ è¾“</span><br><span class="line">	SOCK_DGRAM: UDPä¼ è¾“</span><br><span class="line">	SOCK_RAW: åŸå§‹ç½‘ç»œè®¿é—®</span><br><span class="line">(3) protocol</span><br><span class="line">	ä¼ 0å³å¯ï¼Œä½¿ç”¨é»˜è®¤åè®®</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: è¿”å›æŒ‡å‘æ–°åˆ›å»ºçš„socketçš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">	å¤±è´¥: è¿”å›-1ï¼Œè®¾ç½®errno</span><br></pre></td></tr></table></figure>
<h3 id="2-bind"><a href="#2-bind" class="headerlink" title="2.bind()"></a>2.bind()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;sys/types.h&gt;</span><br><span class="line">#include&lt;sys/socket.h&gt;</span><br><span class="line"></span><br><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">int bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen);</span><br><span class="line">ä½œç”¨: å°†å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦å’Œä¸€ä¸ªåœ°å€ç±»å‹å˜é‡è¿›è¡Œç»‘å®š</span><br><span class="line">å‚æ•°:</span><br><span class="line">(1) sockfd</span><br><span class="line">	socketæ–‡ä»¶æè¿°ç¬¦(ç›‘å¬ç«¯å£çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦)ï¼Œå³è°ƒç”¨socket()å‡½æ•°è¿”å›çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">(2) addr</span><br><span class="line">	ä¸ç½‘ç»œç›¸å…³çš„å±æ€§ä¿¡æ¯ï¼ŒåŒ…æ‹¬åè®®å®¶æ—ã€ipåœ°å€å’Œç«¯å£å·ç­‰(éœ€è¦ç»‘å®šçš„ipå’Œç«¯å£)</span><br><span class="line">(3) addrlen</span><br><span class="line">	addrç»“æ„ä½“çš„é•¿åº¦</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: è¿”å›0</span><br><span class="line">	å¤±è´¥: è¿”å›-1ï¼Œè®¾ç½®errno</span><br><span class="line">å¤‡æ³¨:</span><br><span class="line">	ä½¿ç”¨socket()åˆ›å»ºå®Œå¥—æ¥å­—ååªæ˜¯åœ¨ç³»ç»Ÿå±‚é¢æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†å¹¶æ²¡æœ‰å°†è¯¥æ–‡ä»¶ä¸ç½‘ç»œå…³è”èµ·æ¥ï¼Œéœ€è¦è°ƒç”¨bind()è¿›è¡Œæ–‡ä»¶å’Œç½‘ç»œçš„ç»‘å®šå’Œå…³è”</span><br><span class="line">	æœåŠ¡å™¨éœ€è¦ç»‘å®šç›‘å¬çš„ç½‘ç»œåœ°å€å’Œç«¯å£å·ï¼Œè€Œå®¢æœç«¯ä¸éœ€è¦</span><br><span class="line">	INADDR_ANYè¡¨ç¤ºç»‘å®š</span><br></pre></td></tr></table></figure>
<h3 id="3-recvfrom"><a href="#3-recvfrom" class="headerlink" title="3.recvfrom()"></a>3.recvfrom()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;sys/types.h&gt;</span><br><span class="line">#include&lt;sys/socket.h&gt;</span><br><span class="line"></span><br><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">ssize_t recvfrom(int sockfd, void *buf, size_t len, int flags, struct sockaddr *src_addr, socklen_t *addrlen);</span><br><span class="line">ä½œç”¨: é€šè¿‡å¥—æ¥å­—æ¥æ”¶æ•°æ®</span><br><span class="line">å‚æ•°:</span><br><span class="line">(1) sockfd</span><br><span class="line">	socketæ–‡ä»¶æè¿°ç¬¦(ç›‘å¬ç«¯å£çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦)ï¼Œå³è°ƒç”¨socket()å‡½æ•°è¿”å›çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">(2) buf</span><br><span class="line">	æ¥æ”¶çš„æ•°æ®å­˜æ”¾çš„ç¼“å†²åŒº</span><br><span class="line">(3) len</span><br><span class="line">	æ¥æ”¶æ•°æ®å­—èŠ‚æ•°</span><br><span class="line">(4) flags</span><br><span class="line">	æ¥æ”¶æ–¹å¼ï¼Œä¸€èˆ¬è®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºé˜»å¡æ¥æ”¶</span><br><span class="line">(5) src_addr</span><br><span class="line">	ä¸å¯¹ç«¯ç½‘ç»œç›¸å…³çš„å±æ€§ä¿¡æ¯ï¼ŒåŒ…æ‹¬åè®®å®¶æ—ã€ipåœ°å€å’Œç«¯å£å·ç­‰</span><br><span class="line">	æŒ‡å‘å‘é€æ•°æ®çš„ä¸»æœºåœ°å€ä¿¡æ¯çš„ç»“æ„ä½“ï¼Œå³å¯ä»¥ä»è¯¥å‚æ•°è·å–åˆ°æ•°æ®æ˜¯è°å‘å‡ºçš„</span><br><span class="line">(6) addrlen</span><br><span class="line">	src_addrç»“æ„ä½“é•¿åº¦</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: è¿”å›å®é™…æ¥æ”¶çš„å­—èŠ‚æ•°</span><br><span class="line">	å¤±è´¥: è¿”å›-1ï¼Œè®¾ç½®errno</span><br></pre></td></tr></table></figure>
<h3 id="4-sendto"><a href="#4-sendto" class="headerlink" title="4.sendto()"></a>4.sendto()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;sys/types.h&gt;</span><br><span class="line">#include&lt;sys/socket.h&gt;</span><br><span class="line"></span><br><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">ssize_t sendto(int sockfd, const void *buf, size_t len, int flags, const struct sockaddr *dest_addr, socklen_t addrlen);</span><br><span class="line">ä½œç”¨: é€šè¿‡å¥—æ¥å­—å‘é€æ•°æ®</span><br><span class="line">å‚æ•°:</span><br><span class="line">(1) sockfd</span><br><span class="line">	socketæ–‡ä»¶æè¿°ç¬¦(ç›‘å¬ç«¯å£çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦)ï¼Œå³è°ƒç”¨socket()å‡½æ•°è¿”å›çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">(2) buf</span><br><span class="line">	å¾…å‘é€æ•°æ®å­˜æ”¾çš„ç¼“å†²åŒº</span><br><span class="line">(3) len</span><br><span class="line">	å¾…å‘é€æ•°æ®å­—èŠ‚æ•°</span><br><span class="line">(4) flags</span><br><span class="line">	å‘é€æ–¹å¼ï¼Œä¸€èˆ¬è®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºé˜»å¡å‘é€</span><br><span class="line">(5) dest_addr</span><br><span class="line">	ä¸å¯¹ç«¯ç½‘ç»œç›¸å…³çš„å±æ€§ä¿¡æ¯ï¼ŒåŒ…æ‹¬åè®®å®¶æ—ã€ipåœ°å€å’Œç«¯å£å·ç­‰</span><br><span class="line">	æŒ‡å‘æ¥æ”¶æ•°æ®çš„ä¸»æœºåœ°å€ä¿¡æ¯çš„ç»“æ„ä½“ï¼Œå³æŒ‡å®šæ•°æ®è¦å‘é€åˆ°å“ªä¸ªä¸»æœºçš„å“ªä¸ªè¿›ç¨‹</span><br><span class="line">(6) addrlen</span><br><span class="line">	dest_addrç»“æ„ä½“é•¿åº¦</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: è¿”å›å®é™…å‘é€çš„å­—èŠ‚æ•°</span><br><span class="line">	å¤±è´¥: è¿”å›-1ï¼Œè®¾ç½®errno</span><br></pre></td></tr></table></figure>
<h3 id="5-close"><a href="#5-close" class="headerlink" title="5.close()"></a>5.close()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;unistd.h&gt;</span><br><span class="line"></span><br><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">int close(int fd);</span><br><span class="line">ä½œç”¨: å…³é—­åˆ›å»ºçš„socket</span><br><span class="line">å‚æ•°:</span><br><span class="line">	fd</span><br><span class="line">	socket()å‡½æ•°è¿”å›çš„fd</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: è¿”å›0</span><br><span class="line">	å¤±è´¥: è¿”å›-1ï¼Œè®¾ç½®errno</span><br></pre></td></tr></table></figure>
<h3 id="6-inet-addr-inet-ntoa"><a href="#6-inet-addr-inet-ntoa" class="headerlink" title="6.inet_addr()/inet_ntoa()"></a>6.inet_addr()/inet_ntoa()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">in_addr_t inet_addr(const char *cp);</span><br><span class="line">ç±»ä¼¼äºinet_aton()å‡½æ•°</span><br><span class="line">å‚æ•°:</span><br><span class="line">cp: å¾…è½¬æ¢å­—ç¬¦ä¸²ip</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	è½¬æ¢åçš„æ•´æ•°ip</span><br><span class="line"></span><br><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">char *inet_ntoa(struct in_addr in);</span><br><span class="line">å‚æ•°:</span><br><span class="line">in: å¾…è½¬æ¢æ•´æ•°ip</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	è½¬æ¢åçš„å­—ç¬¦ä¸²ip</span><br></pre></td></tr></table></figure>
<h3 id="7-connect"><a href="#7-connect" class="headerlink" title="7.connect()"></a>7.connect()</h3><blockquote>
<p><code>udp</code>å¥—æ¥å­—ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œå› è€Œ<code>udp</code>å¥—æ¥å­—å¯ä»¥åˆ†ä¸ºå·²è¿æ¥çš„<code>udp</code>å¥—æ¥å­—å’Œæœªè¿æ¥çš„<code>udp</code>å¥—æ¥å­—</p>
<p>å·²è¿æ¥çš„<code>udp</code>å¥—æ¥å­—ï¼Œå¿…é¡»å…ˆç»è¿‡<code>connect()</code>æ¥å‘ç›®æ ‡æœåŠ¡å™¨è¿›è¡ŒæŒ‡å®šï¼Œç„¶åè°ƒç”¨<code>read/write</code>è¿›è¡Œä¿¡æ¯çš„æ”¶å‘ï¼Œç›®æ ‡ä¸»æœºçš„<code>IP</code>å’Œç«¯å£æ˜¯åœ¨<code>connect()</code>æ—¶ç¡®å®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦<code>conenct()</code>æˆåŠŸï¼Œæˆ‘ä»¬å°±åªèƒ½æ”¶å‘è¯¥ä¸»æœºçš„ä¿¡æ¯</p>
<p>å½“çŸ¥é“ç›®çš„åœ°å€å’Œç«¯å£æ—¶ï¼Œé‡‡ç”¨è¿æ¥çš„<code>udp</code>å¥—æ¥å­—æ•ˆç‡æ›´é«˜</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/Thee24LYJ/Pic_Image/images/1093303-20170115202743119-1345209901.jpg" alt="1093303-20170115202743119-1345209901"></p>
<p>å‚è€ƒ: <a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_52169086/article/details/125698902?spm=1001.2014.3001.5506">socketç¼–ç¨‹TCPç¨‹åº</a></p>
<p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/socket-programming-cc/">Socket Programming in C/C++</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/Thee24LYJ/Pic_Image/images/StatediagramforserverandclientmodelofSocketdrawio2-448x660.png" alt="StatediagramforserverandclientmodelofSocketdrawio2-448x660"></p>
<h3 id="1-listen"><a href="#1-listen" class="headerlink" title="1.listen()"></a>1.listen()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">int listen(int sockfd, int backlog);</span><br><span class="line">ä½œç”¨: It puts the server socket in a passive mode, where it waits for the client to approach the server to make a connection.</span><br><span class="line">å‚æ•°:</span><br><span class="line">(1) sockfd</span><br><span class="line">	éœ€è¦ç›‘å¬å¥—æ¥å­—å¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">(2) backlog</span><br><span class="line">	å…¨è¿æ¥é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦ã€‚å¦‚æœæœ‰å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å‘æ¥è¿æ¥è¯·æ±‚ï¼Œæ­¤æ—¶æœªè¢«æœåŠ¡å™¨å¤„ç†çš„è¿æ¥å°±ä¼šæ”¾å…¥è¿æ¥é˜Ÿåˆ—(è¶…å‡ºçš„è¿æ¥è¯·æ±‚ä¼šè¢«å¿½ç•¥)ï¼Œè¯¥å‚æ•°ä»£è¡¨çš„å°±æ˜¯è¿™ä¸ªå…¨è¿æ¥é˜Ÿåˆ—çš„æœ€å¤§é•¿åº¦ï¼Œä¸€èˆ¬ä¸è¦è®¾ç½®å¤ªå¤§ï¼Œè®¾ç½®ä¸º5æˆ–10å³å¯</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: è¿”å›0</span><br><span class="line">	å¤±è´¥: è¿”å›-1ï¼Œè®¾ç½®errno</span><br></pre></td></tr></table></figure>
<h3 id="2-accept"><a href="#2-accept" class="headerlink" title="2.accept()"></a>2.accept()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">int accept(int sockfd, struct sockaddr *addr, socklen_t *addrlen);</span><br><span class="line">ä½œç”¨: It extracts the first connection request on the queue of pending connections for the listening socket, sockfd, creates a new connected socket, and returns a new file descriptor referring to that socket. At this point, the connection is established between client and server, and they are ready to transfer data.</span><br><span class="line">å‚æ•°:</span><br><span class="line">(1) sockfd</span><br><span class="line">	éœ€è¦ç›‘å¬å¥—æ¥å­—å¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦(ç›‘å¬å¥—æ¥å­—)</span><br><span class="line">(2) addr</span><br><span class="line">	å¯¹ç«¯ç½‘ç»œç›¸å…³å±æ€§ä¿¡æ¯ï¼ŒåŒ…æ‹¬åè®®å®¶æ—ã€ipå’Œç«¯å£ç­‰</span><br><span class="line">(3) addrlen</span><br><span class="line">	addrç»“æ„ä½“é•¿åº¦ï¼Œè¿”å›å®é™…è¯»å–åˆ°çš„addrç»“æ„ä½“é•¿åº¦(è¾“å…¥è¾“å‡ºå‹å‚æ•°)</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: è¿”å›ä¸€ä¸ªæ–°çš„socketæ–‡ä»¶æè¿°ç¬¦(æœåŠ¡å¥—æ¥å­—)ï¼Œç”¨äºå’Œå®¢æˆ·ç«¯é€šä¿¡</span><br><span class="line">	å¤±è´¥: è¿”å›-1ï¼Œè®¾ç½®errno</span><br><span class="line">1.ç›‘å¬å¥—æ¥å­—ï¼šç”¨äºè·å–å®¢æˆ·ç«¯å‘æ¥çš„è¿æ¥è¯·æ±‚ã€‚acceptå‡½æ•°ä¼šä¸æ–­ä»ç›‘å¬å¥—æ¥å­—å½“ä¸­è·å–æ–°è¿æ¥ã€‚</span><br><span class="line">2.acceptå‡½æ•°è¿”å›çš„å¥—æ¥å­—ï¼šç”¨äºä¸ºæœ¬æ¬¡acceptè·å–åˆ°çš„è¿æ¥æä¾›æœåŠ¡ã€‚ç›‘å¬å¥—æ¥å­—çš„ä»»åŠ¡åªæ˜¯ä¸æ–­è·å–æ–°è¿æ¥ï¼Œè€ŒçœŸæ­£ä¸ºè¿™äº›è¿æ¥æä¾›æœåŠ¡çš„å¥—æ¥å­—æ˜¯acceptå‡½æ•°è¿”å›çš„å¥—æ¥å­—</span><br></pre></td></tr></table></figure>
<h3 id="3-connect"><a href="#3-connect" class="headerlink" title="3.connect()"></a>3.connect()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">int connect(int sockfd, const struct sockaddr *addr, socklen_t addrlen);</span><br><span class="line">ä½œç”¨:  The connect() system call connects the socket referred to by the file descriptor sockfd to the address specified by addr. Server&#x27;s address and port is specified in addr.</span><br><span class="line">å‚æ•°:</span><br><span class="line">(1) sockfd</span><br><span class="line">	éœ€è¦è¿æ¥å¥—æ¥å­—å¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦(é€šè¿‡è¯¥å¥—æ¥å­—å‘èµ·è¿æ¥è¯·æ±‚)</span><br><span class="line">(2) addr</span><br><span class="line">	å¯¹ç«¯ç½‘ç»œç›¸å…³å±æ€§ä¿¡æ¯ï¼ŒåŒ…æ‹¬åè®®å®¶æ—ã€ipå’Œç«¯å£ç­‰</span><br><span class="line">(3) addrlen</span><br><span class="line">	addrç»“æ„ä½“é•¿åº¦</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: è¿æ¥æˆåŠŸ</span><br><span class="line">	å¤±è´¥: è¿”å›-1ï¼Œè®¾ç½®errno</span><br></pre></td></tr></table></figure>
<h3 id="4-read"><a href="#4-read" class="headerlink" title="4.read()"></a>4.read()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">ssize_t read(int fd, void *buf, size_t count);</span><br><span class="line">ä½œç”¨: ä»è¿æ¥çš„å¥—æ¥å­—ä¸­è¯»å–æ•°æ®</span><br><span class="line">å‚æ•°:</span><br><span class="line">(1) fd</span><br><span class="line">	å¯¹åº”å¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">(2) buf</span><br><span class="line">	è¯»å–åˆ°çš„æ•°æ®å­˜å‚¨ä½ç½®</span><br><span class="line">(3) count</span><br><span class="line">	è¯»å–æ•°æ®å­—èŠ‚æ•°</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: å®é™…è¯»å–çš„å­—èŠ‚æ•°</span><br><span class="line">	å¤±è´¥: è¿”å›0(æ–‡ä»¶ç»“æŸ/å¯¹ç«¯å…³é—­è¿æ¥)æˆ–-1(è¯»å–é”™è¯¯)ï¼Œè®¾ç½®errno</span><br></pre></td></tr></table></figure>
<h3 id="5-write"><a href="#5-write" class="headerlink" title="5.write()"></a>5.write()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">ssize_t write(int fd, const void *buf, size_t count);</span><br><span class="line">ä½œç”¨: ä»è¿æ¥çš„å¥—æ¥å­—ä¸­è¯»å–æ•°æ®</span><br><span class="line">å‚æ•°:</span><br><span class="line">(1) fd</span><br><span class="line">	å¯¹åº”å¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">(2) buf</span><br><span class="line">	éœ€è¦å†™å…¥æ•°æ®çš„ä½ç½®</span><br><span class="line">(3) count</span><br><span class="line">	å†™å…¥æ•°æ®å­—èŠ‚æ•°</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: å®é™…å†™å…¥çš„å­—èŠ‚æ•°</span><br><span class="line">	å¤±è´¥: è¿”å›-1ï¼Œè®¾ç½®errno</span><br></pre></td></tr></table></figure>
<h3 id="6-setsockopt"><a href="#6-setsockopt" class="headerlink" title="6.setsockopt()"></a>6.setsockopt()</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;sys/socket.h&gt;</span><br><span class="line">å‡½æ•°åŸå‹:</span><br><span class="line">int setsockopt(int sockfd, int level, int optname,  const void *optval, socklen_t optlen);</span><br><span class="line">ä½œç”¨:</span><br><span class="line">	This helps in manipulating options for the socket referred by the file descriptor sockfd. This is completely optional, but it helps in reuse of address and port. Prevents error such as: &quot;address already in use&quot;</span><br><span class="line">å‚æ•°:</span><br><span class="line">(1) sockfd</span><br><span class="line">	å¥—æ¥å­—æè¿°ç¬¦</span><br><span class="line">(2) level</span><br><span class="line">	è®¾ç½®é€‰é¡¹çš„çº§åˆ«ï¼Œå¦‚æœæƒ³è¦åœ¨å¥—æ¥å­—çº§åˆ«ä¸Šè®¾ç½®é€‰é¡¹ï¼Œå°±å¿…é¡»æŠŠlevelè®¾ç½®ä¸º SOL_SOCKET</span><br><span class="line">(3) optname</span><br><span class="line">	éœ€è¦è®¾ç½®çš„é€‰é¡¹</span><br><span class="line">(4) optval</span><br><span class="line">	æŒ‡å‘å­˜æ”¾é€‰é¡¹å€¼çš„ç¼“å†²åŒº</span><br><span class="line">(5) optlen</span><br><span class="line">	optval ç¼“å†²åŒºçš„é•¿åº¦</span><br><span class="line">è¿”å›å€¼:</span><br><span class="line">	æˆåŠŸ: è¿”å›0</span><br><span class="line">	å¤±è´¥: è¿”å›-1, è®¾ç½®errno</span><br></pre></td></tr></table></figure>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/cthon/p/9270778.html">setsockoptå‡½æ•°åŠŸèƒ½åŠå‚æ•°è¯¦è§£</a></p>
<ul>
<li>é˜»å¡æ¥æ”¶æ—¶é¿å…æ°¸ä¹…é˜»å¡</li>
</ul>
<p>ä¼ ç»Ÿçš„recvfromæ˜¯é˜»å¡è¿›è¡Œçš„ï¼Œå³è°ƒç”¨recvfromä¹‹åç¨‹åºå°±ä¼šé˜»å¡ï¼Œç­‰å¾…æ•°æ®åŒ…çš„åˆ°æ¥ï¼Œå¦‚æœæ²¡æœ‰æ•°æ®åŒ…ï¼Œç¨‹åºå°±æ°¸è¿œç­‰å¾…</p>
<p>è§£å†³æ–¹æ³•ï¼šç»™å®¢æˆ·ç«¯è°ƒç”¨çš„<code>recvfrom()</code>å‡½æ•°è®¾ç½®è¶…æ—¶å¤„ç†ï¼Œè¶…æ—¶ä¹‹åæ²¡æœ‰æ¥æ”¶åˆ°æ•°æ®å°±ç›´æ¥è¿”å›</p>
<p>ï¼ˆ1ï¼‰select()å‡½æ•°+recvfrom()å‡½æ•°</p>
<p>å¯¹äºselect()å‡½æ•°ï¼Œå¯å‚è€ƒ: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/wuyepeng/p/9745573.html">selectå‡½æ•°åŠfd_setä»‹ç»</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">timeval</span> tv;</span><br><span class="line">    fd_set readfds;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> n=<span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> buf_n=<span class="number">1024</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">FD_ZERO</span>(&amp;readfds);	<span class="comment">// æ¸…ç©º</span></span><br><span class="line">        <span class="built_in">FD_SET</span>(fd,&amp;readfds);	<span class="comment">// ç½®ä½fdï¼Œå°†éœ€è¦å¤„ç†çš„sockåŠ å…¥åˆ°ä¸Šä¸€æ­¥æ¸…ç©ºåçš„é›†åˆä¸­</span></span><br><span class="line">        <span class="comment">// è®¾ç½®è¶…æ—¶å‚æ•° secå’Œusec</span></span><br><span class="line">        tv.tv_sec=sec;</span><br><span class="line">        tv.tv_usec=usec;</span><br><span class="line">        <span class="comment">// ä»¥éé˜»å¡æ–¹å¼è°ƒç”¨select()å‡½æ•°ï¼Œè®¾ç½®æ—¶é—´å†…æœ‰æ•°æ®åˆ™è¿”å›å¹¶è®¾ç½®readfdsä¸­fdå¯¹åº”ä½ä¸º1ï¼Œå¦åˆ™è¿”å›å¹¶è®¾ç½®readfdsä¸­å¯¹åº”ä½ä¸º0</span></span><br><span class="line">        <span class="built_in">select</span>(fd+<span class="number">1</span>,&amp;readfds,<span class="literal">NULL</span>,<span class="literal">NULL</span>,&amp;tv);</span><br><span class="line">        <span class="comment">// æµ‹è¯•readfdsä¸­fdå¯¹åº”ä½æœ‰æ²¡æœ‰ç½®1ï¼Œå¦‚æœç½®1åˆ™è¿”å›æˆåŠŸï¼Œå¦åˆ™è¿”å›å¤±è´¥</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">FD_ISSET</span>(fd,&amp;readfds))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>((n=<span class="built_in">recvfrom</span>(fd,buf,buf_n,<span class="number">0</span>,&amp;addr,&amp;len))&gt;=<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// æˆåŠŸæ¥æ”¶å¤„ç†ä»£ç </span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="comment">// è¶…æ—¶å¤„ç†ä»£ç </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼š</p>
<ul>
<li><p>å¦‚æœè®¾å®šæ—¶é—´å†…æ²¡æœ‰æ•°æ®åˆ°æ¥è¿˜æƒ³ç»§ç»­ç­‰å¾…Næ¬¡ï¼Œé‚£ä¹ˆä¸€å®šè¦æ³¨æ„é‡æ–°è®¾ç½®readfdsï¼Œå› ä¸ºå®ƒå·²ç»è¢«selectç ´åäº†ï¼Œå¦‚æœä¸é‡æ–°è®¾ç½®çš„è¯ï¼Œä½ çš„selectè¯­å¥ä¼šè¿”å›-1ï¼Œstrerræ—¶ä¼šæ‰“å°å‡ºå‚æ•°è®¾ç½®å‡ºé”™ï¼Œä¸»è¦æ˜¯ç”±äºreadfdsä¸­å…¨éƒ¨ä¸ºé›¶ï¼Œselectä¸çŸ¥é“è¯¥å»ç›‘è§†å“ªä¸ªsock</p>
</li>
<li><p>é‡å¤ç­‰å¾…æ—¶ä¸åªæ˜¯è¦é‡æ–°è®¾ç½®readfdsï¼ŒåŒæ—¶è¿˜è¦é‡æ–°è®¾ç½®ä¸€ä¸‹tvçš„å€¼ï¼Œå› ä¸ºselectåŒæ—¶ä¹Ÿç ´åäº†tvçš„å€¼ï¼ˆselectåœ¨è¿”å›æ—¶ä¼šæ”¹å˜tvï¼Œæ”¹å˜çš„å…¬å¼æ˜¯tv=tv-ç­‰å¾…çš„æ—¶é—´ï¼Œæ‰€ä»¥å¦‚æœtvæ—¶é—´å†…æ²¡æœ‰æ•°æ®åˆ°è¾¾çš„è¯ï¼Œselectè¿”å›æ—¶tvä¼šå˜æˆ0ï¼‰</p>
</li>
</ul>
<p>ï¼ˆ2ï¼‰<a target="_blank" rel="noopener" href="https://blog.csdn.net/daiyudong2020/article/details/70039409">UDPæœåŠ¡recvfromå‡½æ•°è®¾ç½®éé˜»å¡</a></p>
<p>ï¼ˆ3ï¼‰<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/612347070">Linux Socket ç½‘ç»œç¼–ç¨‹ é˜»å¡ä¸éé˜»å¡ æ–­çº¿é‡è¿æœºåˆ¶</a></p>
<p>ï¼ˆ4ï¼‰ä½¿ç”¨ä¿¡å·ä¸­æ–­å¤„ç†è¶…æ—¶</p>
<h1 id="Linuxç³»ç»Ÿ"><a href="#Linuxç³»ç»Ÿ" class="headerlink" title="Linuxç³»ç»Ÿ"></a>Linuxç³»ç»Ÿ</h1><blockquote>
<p>Linuxç³»ç»Ÿä¸‹å…³äºä½¿ç”¨socketè¿›è¡ŒUDPå’ŒTCPé€šä¿¡çš„ä»£ç å·²æ”¾åˆ°å¦‚ä¸‹é“¾æ¥ä¸­ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Thee24LYJ/LearningCode/tree/main/tcp%26udp%20socket%20code">https://github.com/Thee24LYJ/LearningCode/tree/main/tcp%26udp%20socket%20code</a></p>
<p>è¯¥æ–‡ä»¶å¤¹ä¸‹å­æ–‡ä»¶å¤¹å¯¹åº”çš„ä»£ç è§£é‡Šå¦‚ä¸‹ï¼š</p>
<ul>
<li>udp_test -&gt; udpé€šä¿¡</li>
<li>tcp_test -&gt; tcpé€šä¿¡</li>
<li>tcp_test_SIGCHLD -&gt; tcpé€šä¿¡(å¤šè¿›ç¨‹ä¹‹æ•æ‰SIGCHLDä¿¡å·)</li>
<li>tcp_test_son -&gt; tcpé€šä¿¡(å¤šè¿›ç¨‹ä¹‹å­™å­è¿›ç¨‹)</li>
<li>tcp_test_thread -&gt; tcpé€šä¿¡(å¤šçº¿ç¨‹)</li>
<li>tcp_test_threadpool -&gt; tcpé€šä¿¡(çº¿ç¨‹æ± )</li>
</ul>
</blockquote>
<h2 id="ä¸€ã€UDP"><a href="#ä¸€ã€UDP" class="headerlink" title="ä¸€ã€UDP"></a>ä¸€ã€UDP</h2><ul>
<li>æœ¬åœ°ä¸åŒè¿›ç¨‹é—´è¿›è¡Œé€šä¿¡ï¼š<a target="_blank" rel="noopener" href="https://juejin.cn/s/unix%20domain%20socket%20%E7%BC%96%E7%A8%8B">unix domain socket ç¼–ç¨‹</a></li>
</ul>
<h2 id="äºŒã€TCP"><a href="#äºŒã€TCP" class="headerlink" title="äºŒã€TCP"></a>äºŒã€TCP</h2><blockquote>
<p>å•è¿›ç¨‹ç‰ˆæœ¬ï¼šä¸€ä¸ªserveråŒä¸€æ—¶åˆ»åªèƒ½å“åº”ä¸€ä¸ªclientçš„è¯·æ±‚</p>
<p>å¤šè¿›ç¨‹çš„tcpç¤ºä¾‹</p>
<ul>
<li><p>å­è¿›ç¨‹ç»§æ‰¿çˆ¶è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦è¡¨: å³çˆ¶è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦æ˜¯3ï¼Œæ­¤æ—¶çˆ¶è¿›ç¨‹åˆ›å»ºçš„å­è¿›ç¨‹çš„3å·æ–‡ä»¶æè¿°ç¬¦ä¹Ÿä¼šæŒ‡å‘è¿™ä¸ªæ‰“å¼€çš„æ–‡ä»¶ï¼Œè€Œå¦‚æœå­è¿›ç¨‹å†åˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œé‚£ä¹ˆå­è¿›ç¨‹åˆ›å»ºçš„å­è¿›ç¨‹çš„3å·æ–‡ä»¶æè¿°ç¬¦ä¹ŸåŒæ ·ä¼šæŒ‡å‘è¿™ä¸ªæ‰“å¼€çš„æ–‡ä»¶</p>
</li>
<li><p>å­è¿›ç¨‹ç­‰å¾…: çˆ¶è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹åï¼Œéœ€è¦ç­‰å¾…å­è¿›ç¨‹é€€å‡º(å¦åˆ™å­è¿›ç¨‹ä¼šå˜æˆåƒµå°¸è¿›ç¨‹)</p>
<p>  é˜»å¡ç­‰å¾…/éé˜»å¡ç­‰å¾…</p>
<p>  ä¸ç­‰å¾…å­è¿›ç¨‹é€€å‡º: </p>
<ul>
<li>æ•æ‰SIGCHLDä¿¡å·ï¼Œå°†å…¶å¤„ç†åŠ¨ä½œè®¾ç½®ä¸ºå¿½ç•¥ã€‚</li>
<li>è®©ç¥–çˆ¶è¿›ç¨‹åˆ›å»ºçˆ¶è¿›ç¨‹ï¼Œçˆ¶è¿›ç¨‹å†åˆ›å»ºå­™å­è¿›ç¨‹ï¼Œæœ€åè®©å­™å­è¿›ç¨‹ä¸ºå®¢æˆ·ç«¯æä¾›æœåŠ¡(å­™å­è¿›ç¨‹ç”±ç³»ç»Ÿå›æ”¶)(ä¸æ¨è)</li>
</ul>
</li>
</ul>
<p>å¤šçº¿ç¨‹çš„tcpç¤ºä¾‹</p>
<ul>
<li>å½“æœåŠ¡è¿›ç¨‹è°ƒç”¨acceptå‡½æ•°è·å–åˆ°ä¸€ä¸ªæ–°è¿æ¥åï¼Œå°±å¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œè®©è¯¥çº¿ç¨‹ä¸ºå¯¹åº”å®¢æˆ·ç«¯æä¾›æœåŠ¡ã€‚ä¸»çº¿ç¨‹ï¼ˆæœåŠ¡è¿›ç¨‹ï¼‰åˆ›å»ºå‡ºæ–°çº¿ç¨‹åï¼Œä¹Ÿæ˜¯éœ€è¦ç­‰å¾…æ–°çº¿ç¨‹é€€å‡ºçš„ï¼Œå¦åˆ™ä¹Ÿä¼šé€ æˆç±»ä¼¼äºåƒµå°¸è¿›ç¨‹è¿™æ ·çš„é—®é¢˜ã€‚ä½†å¯¹äºçº¿ç¨‹æ¥è¯´ï¼Œå¦‚æœä¸æƒ³è®©ä¸»çº¿ç¨‹ç­‰å¾…æ–°çº¿ç¨‹é€€å‡ºï¼Œå¯ä»¥è®©åˆ›å»ºå‡ºæ¥çš„æ–°çº¿ç¨‹è°ƒç”¨pthread_detachå‡½æ•°è¿›è¡Œçº¿ç¨‹åˆ†ç¦»ï¼Œå½“è¿™ä¸ªçº¿ç¨‹é€€å‡ºæ—¶ç³»ç»Ÿä¼šè‡ªåŠ¨å›æ”¶è¯¥çº¿ç¨‹æ‰€å¯¹åº”çš„èµ„æºã€‚æ­¤æ—¶ä¸»çº¿ç¨‹ï¼ˆæœåŠ¡è¿›ç¨‹ï¼‰å°±å¯ä»¥ç»§ç»­è°ƒç”¨acceptå‡½æ•°è·å–æ–°è¿æ¥ï¼Œè€Œè®©æ–°çº¿ç¨‹å»æœåŠ¡å¯¹åº”çš„å®¢æˆ·ç«¯ã€‚</li>
<li>æ–‡ä»¶æè¿°ç¬¦è¡¨ç»´æŠ¤çš„æ˜¯è¿›ç¨‹ä¸æ–‡ä»¶ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œå› æ­¤ä¸€ä¸ªè¿›ç¨‹å¯¹åº”ä¸€å¼ æ–‡ä»¶æè¿°ç¬¦è¡¨ã€‚è€Œä¸»çº¿ç¨‹åˆ›å»ºå‡ºæ¥çš„æ–°çº¿ç¨‹ä¾æ—§å±äºè¿™ä¸ªè¿›ç¨‹ï¼Œå› æ­¤åˆ›å»ºçº¿ç¨‹æ—¶å¹¶ä¸ä¼šä¸ºè¯¥çº¿ç¨‹åˆ›å»ºç‹¬ç«‹çš„æ–‡ä»¶æè¿°ç¬¦è¡¨ï¼Œæ‰€æœ‰çš„çº¿ç¨‹çœ‹åˆ°çš„éƒ½æ˜¯åŒä¸€å¼ æ–‡ä»¶æè¿°ç¬¦è¡¨ã€‚</li>
<li><p>å½“æœåŠ¡è¿›ç¨‹ï¼ˆä¸»çº¿ç¨‹ï¼‰è°ƒç”¨acceptå‡½æ•°è·å–åˆ°ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦åï¼Œå…¶ä»–åˆ›å»ºçš„æ–°çº¿ç¨‹æ˜¯èƒ½å¤Ÿç›´æ¥è®¿é—®è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦çš„ã€‚è™½ç„¶æ–°çº¿ç¨‹èƒ½å¤Ÿç›´æ¥è®¿é—®ä¸»çº¿ç¨‹acceptä¸Šæ¥çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œä½†æ­¤æ—¶æ–°çº¿ç¨‹å¹¶ä¸çŸ¥é“å®ƒæ‰€æœåŠ¡çš„å®¢æˆ·ç«¯å¯¹åº”çš„æ˜¯å“ªä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œå› æ­¤ä¸»çº¿ç¨‹åˆ›å»ºæ–°çº¿ç¨‹åéœ€è¦å‘Šè¯‰æ–°çº¿ç¨‹å¯¹åº”åº”è¯¥è®¿é—®çš„æ–‡ä»¶æè¿°ç¬¦çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å‘Šè¯‰æ¯ä¸ªæ–°çº¿ç¨‹åœ¨æœåŠ¡å®¢æˆ·ç«¯æ—¶ï¼Œåº”è¯¥å¯¹å“ªä¸€ä¸ªå¥—æ¥å­—è¿›è¡Œæ“ä½œ</p>
</li>
<li><p>ç”±äºä»£ç å½“ä¸­ç”¨åˆ°äº†å¤šçº¿ç¨‹ï¼Œå› æ­¤ç¼–è¯‘æ—¶éœ€è¦æºå¸¦ä¸Š -l pthread é€‰é¡¹ã€‚æ­¤å¤–ï¼Œç”±äºæˆ‘ä»¬ç°åœ¨è¦ç›‘æµ‹çš„æ˜¯ä¸€ä¸ªä¸ªçš„çº¿ç¨‹ï¼Œå› æ­¤åœ¨ç›‘æ§æ—¶ä½¿ç”¨çš„ä¸å†æ˜¯ps -axj å‘½ä»¤ï¼Œè€Œæ˜¯ ps -aL å‘½ä»¤ã€‚</p>
</li>
<li>å½“ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡ç«¯åï¼Œæ­¤æ—¶ä¸»çº¿ç¨‹å°±ä¼šä¸ºè¯¥å®¢æˆ·ç«¯æ„å»ºä¸€ä¸ªå‚æ•°ç»“æ„ä½“ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œå°†è¯¥å‚æ•°ç»“æ„ä½“çš„åœ°å€ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿™ä¸ªæ–°çº¿ç¨‹ï¼Œæ­¤æ—¶è¯¥æ–°çº¿ç¨‹å°±èƒ½å¤Ÿä»è¿™ä¸ªå‚æ•°ç»“æ„ä½“å½“ä¸­æå–å‡ºå¯¹åº”çš„å‚æ•°ï¼Œç„¶åè°ƒç”¨Serviceå‡½æ•°ä¸ºè¯¥å®¢æˆ·ç«¯æä¾›æœåŠ¡</li>
</ul>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://example.com">thee</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2023/07/10/C-C-%E4%B9%8Bsocket%E7%BC%96%E7%A8%8B/">http://example.com/2023/07/10/C-C-%E4%B9%8Bsocket%E7%BC%96%E7%A8%8B/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://example.com" target="_blank">theeã®åšå®¢ ğŸ‰</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/socket%E7%BC%96%E7%A8%8B/">socketç¼–ç¨‹</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/Thee24LYJ/Pic_Image/images/022c23204ba7816e279cc352e332b74b6f656da2.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/07/10/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B9%8B%E9%9D%99%E6%80%81arp%E7%BB%91%E5%AE%9A/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/Thee24LYJ/Pic_Image/images/022c23204ba7816e279cc352e332b74b6f656da2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">è®¡ç®—æœºä¹‹é™æ€ arp ç»‘å®š</div></div></a></div><div class="next-post pull-right"><a href="/2023/08/14/%E3%80%8Alinux%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%A4%A7%E5%85%A8%E3%80%8B%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/Thee24LYJ/Pic_Image/images/022c23204ba7816e279cc352e332b74b6f656da2.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">ã€Šlinuxå‘½ä»¤è¡Œå¤§å…¨ã€‹é˜…è¯»ç¬”è®°</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-text">å¥—æ¥å­—ç›¸å…³å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-socket"><span class="toc-text">1.socket()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-bind"><span class="toc-text">2.bind()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-recvfrom"><span class="toc-text">3.recvfrom()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-sendto"><span class="toc-text">4.sendto()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-close"><span class="toc-text">5.close()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-inet-addr-inet-ntoa"><span class="toc-text">6.inet_addr()&#x2F;inet_ntoa()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-connect"><span class="toc-text">7.connect()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-listen"><span class="toc-text">1.listen()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-accept"><span class="toc-text">2.accept()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-connect"><span class="toc-text">3.connect()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-read"><span class="toc-text">4.read()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-write"><span class="toc-text">5.write()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-setsockopt"><span class="toc-text">6.setsockopt()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Linux%E7%B3%BB%E7%BB%9F"><span class="toc-text">Linuxç³»ç»Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81UDP"><span class="toc-text">ä¸€ã€UDP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81TCP"><span class="toc-text">äºŒã€TCP</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/Thee24LYJ/Pic_Image/images/022c23204ba7816e279cc352e332b74b6f656da2.png')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By thee</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="åšå®¢æ¡†æ¶ä¸ºHexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="ä¸»é¢˜é‡‡ç”¨butterfly"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="æœ¬ç«™é¡¹ç›®ç”±Gtihubæ‰˜ç®¡"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="/assets/js/cursor.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>